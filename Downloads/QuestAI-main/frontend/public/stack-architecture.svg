<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<svg xmlns="http://www.w3.org/2000/svg" width="1280" height="760" viewBox="0 0 1280 760">
  <defs>
    <style type="text/css"><![CDATA[
      .title { font: 700 22px/1.3 "Inter", system-ui, -apple-system, Segoe UI, Roboto, Arial; fill: #111827; }
      .subtitle { font: 600 14px/1.3 "Inter", system-ui, -apple-system, Segoe UI, Roboto, Arial; fill: #1f2937; }
      .small { font: 12px/1.3 "Inter", system-ui, -apple-system, Segoe UI, Roboto, Arial; fill: #374151; }
      .mono { font: 12px/1.3 ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace; fill: #111827; }
      .box { fill: #ffffff; stroke: #d1d5db; stroke-width: 1.2; rx: 10; }
      .pill { fill: #eef2ff; stroke: #c7d2fe; stroke-width: 1; rx: 14; }
      .accent { fill: #f0f9ff; stroke: #bae6fd; stroke-width: 1.2; rx: 10; }
      .panel { fill: #f9fafb; stroke: #e5e7eb; stroke-width: 1.2; rx: 12; }
      .arrow { stroke: #6b7280; stroke-width: 2; marker-end: url(#arrowhead); fill: none; }
      .arrow-strong { stroke: #111827; stroke-width: 2.5; marker-end: url(#arrowheadStrong); fill: none; }
      .label { font: 12px/1.3 "Inter", system-ui, -apple-system, Segoe UI, Roboto, Arial; fill: #374151; }
    ]]></style>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="10" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#6b7280" />
    </marker>
    <marker id="arrowheadStrong" markerWidth="12" markerHeight="8" refX="12" refY="4" orient="auto">
      <polygon points="0 0, 12 4, 0 8" fill="#111827" />
    </marker>
  </defs>

  <!-- Title -->
  <text x="40" y="48" class="title">Challo Tech Stack and Agent Flow</text>
  <text x="40" y="72" class="small">Full-stack: Vite + React (Netlify) → FastAPI (Railway) → Multi-agent planning with tools and optional LLMs</text>

  <!-- Frontend Panel -->
  <rect x="40" y="110" width="360" height="240" class="panel"/>
  <text x="60" y="140" class="subtitle">Frontend (Vite + React, TypeScript)</text>
  <rect x="60" y="160" width="320" height="72" class="box"/>
  <text x="76" y="186" class="small">UI: `frontend/src/App.tsx`</text>
  <text x="76" y="206" class="small">Inputs: mood text, friends, location, time</text>
  <rect x="60" y="242" width="320" height="88" class="box"/>
  <text x="76" y="268" class="small">API client: `frontend/src/lib/api.ts`</text>
  <text x="76" y="288" class="mono">POST /api/v1/plan</text>
  <text x="76" y="306" class="small">Netlify build with `VITE_API_BASE_URL` → Railway API</text>

  <!-- Hosting badges -->
  <rect x="60" y="338" width="140" height="28" class="pill"/>
  <text x="76" y="357" class="small">Netlify (static hosting)</text>
  <rect x="210" y="338" width="170" height="28" class="pill"/>
  <text x="226" y="357" class="small">.env: VITE_API_BASE_URL</text>

  <!-- Backend Panel -->
  <rect x="470" y="110" width="770" height="540" class="panel"/>
  <text x="490" y="140" class="subtitle">Backend (FastAPI on Railway)</text>
  <rect x="490" y="160" width="340" height="90" class="box"/>
  <text x="506" y="186" class="small">Service: `backend/api.py`</text>
  <text x="506" y="206" class="mono">POST /api/v1/plan → orchestrator.plan()</text>

  <!-- Orchestrator -->
  <rect x="490" y="270" width="730" height="360" class="accent"/>
  <text x="506" y="294" class="subtitle">Orchestrator (`backend/orchestrator.py`)</text>

  <!-- Listener Agent -->
  <rect x="510" y="314" width="260" height="88" class="box"/>
  <text x="526" y="338" class="small">ListenerAgent (`agents.py`)</text>
  <text x="526" y="358" class="small">Parses mood → {vibe, budget, energy, time_hint}</text>
  <text x="526" y="378" class="small">LLM (optional): Gemini via `GEMINI_API_KEY`</text>

  <!-- Planner Agent -->
  <rect x="820" y="314" width="380" height="170" class="box"/>
  <text x="836" y="338" class="small">PlannerAgent (`agents.py`)</text>
  <text x="836" y="358" class="small">Merges tastes + constraints; queries activities</text>
  <rect x="836" y="370" width="348" height="32" class="pill"/>
  <text x="850" y="391" class="small">tool_get_user_taste (mock → Supabase later)</text>
  <rect x="836" y="406" width="348" height="32" class="pill"/>
  <text x="850" y="427" class="small">tool_merge_tastes (heuristic merge)</text>
  <rect x="836" y="442" width="348" height="32" class="pill"/>
  <text x="850" y="463" class="small">tool_find_activities (Google Places, Eventbrite)</text>

  <!-- Writer Agent -->
  <rect x="510" y="420" width="260" height="150" class="box"/>
  <text x="526" y="444" class="small">WriterAgent (`agents.py`)</text>
  <text x="526" y="464" class="small">Scores candidates → PlanCards (top 3–5)</text>
  <text x="526" y="484" class="small">Deterministic scoring in code (no LLM required)</text>
  <text x="526" y="504" class="small">Models: `backend/schemas.py`</text>

  <!-- External Services -->
  <rect x="820" y="505" width="380" height="110" class="box"/>
  <text x="836" y="529" class="small">External APIs (optional)</text>
  <rect x="836" y="541" width="170" height="28" class="pill"/>
  <text x="850" y="560" class="small">Google Places (MAPS key)</text>
  <rect x="1016" y="541" width="168" height="28" class="pill"/>
  <text x="1030" y="560" class="small">Eventbrite (API token)</text>

  <!-- Env keys -->
  <rect x="490" y="200" width="340" height="38" class="pill"/>
  <text x="506" y="224" class="small">ENV: GEMINI_API_KEY, GOOGLE_PLACES_API_KEY, EVENTBRITE_API_KEY</text>

  <!-- Data Flow arrows -->
  <!-- Frontend → Backend -->
  <line x1="380" y1="210" x2="490" y2="210" class="arrow-strong"/>
  <text x="390" y="196" class="label">fetchPlan()</text>

  <!-- Listener → Planner -->
  <line x1="770" y1="358" x2="820" y2="358" class="arrow"/>
  <text x="778" y="350" class="label">intent JSON</text>

  <!-- Planner → Writer -->
  <line x1="820" y1="495" x2="770" y2="495" class="arrow"/>
  <text x="782" y="488" class="label">raw candidates</text>

  <!-- Writer → Response -->
  <line x1="770" y1="545" x2="610" y2="545" class="arrow"/>
  <text x="672" y="538" class="label">PlanCards (sorted)</text>

  <!-- Backend → Frontend -->
  <line x1="490" y1="236" x2="380" y2="236" class="arrow-strong"/>
  <text x="394" y="230" class="label">PlanResponse</text>

  <!-- Notes -->
  <text x="40" y="420" class="subtitle">What the agents do</text>
  <text x="40" y="444" class="small">• Listener — structure free-text mood to constraints</text>
  <text x="40" y="464" class="small">• Planner — fetch/merge tastes, search activities via tools</text>
  <text x="40" y="484" class="small">• Writer — score and explain top options</text>
  <text x="40" y="524" class="subtitle">Deployment</text>
  <text x="40" y="548" class="small">• Frontend: Netlify builds `frontend/` (Vite) → served as static site</text>
  <text x="40" y="568" class="small">• Backend: FastAPI on Railway (`uvicorn backend.api:app`)</text>
  <text x="40" y="588" class="small">• Frontend targets backend via `VITE_API_BASE_URL` (see `netlify.toml`)</text>

  <!-- Footer -->
  <text x="40" y="720" class="small">Repo paths: frontend/src/App.tsx · frontend/src/lib/api.ts · backend/api.py · backend/orchestrator.py · backend/agents.py · backend/tools.py · backend/schemas.py</text>
</svg>


